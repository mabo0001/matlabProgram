%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%
%                            MT 2D 模型文件
%             只需输入相应的目标区域，外延区域自动剖分
%
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
clear
clc
Y=0;           % 为固定的
f=[  512,256,128,64,32,16,8,4,2,1,0.5,0.25,0.125,0.0625 0.0313 0.016];
X=[-15000,-10000,-9000,-8000,-7000,-6000,-5000,-4000,-3000,-2000,-1000,0,1000,2000,3000,4000,5000,6000,7000,8000,9000,10000,15000];
Z=[0,100,200,300,400,500,600,800,  1000,1200,1400,1600,1800,2000,    2500,3000,3500,4000,4500,5000,6000,7000,8000,9000,10000,12000,14000,16000,18000,20000,25000,  30000];
body=[ -4000, -2000,  1000, 10000,    10;3000, 7000,  6000, 18000,   10000];  
Sp=[-10000,-9000,-8000,-7000,-6000,-5000,-4000,-3000,-2000,-1000,0,1000,2000,3000,4000,5000,6000,7000,8000,9000,10000];
pp=100;  
m=1.2;
n=4;
% Y为Y方向的单元坐标
% Z为垂直向下的单元坐标
% Sp为测点坐标，分别为：[x1，x2,...xn,];
% body为异常体坐标：分别为[X起始，X终止，Z起始，Z终止，电阻率值]；
% 若异常体某一坐标为无限(如层状模型)，则其坐标赋值为0.01
% pp为背景值
% m为边界扩展系数
% n为一个方向单元宽展数
%%%%%%%%%%%%%%%%%%%%%%%%%% MT2Dmesh.m程序 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Zmish=Z;

Xmish=MT2Dmesh(X,Z,Sp,pp,body,n,m);
body=load('bodymodle'); sc=struct2cell(body); t=cell2mat(sc);    % 读取网格电阻率数据 
pmax=max(t(:));pmin=min(t(:));
%K=(pmax-pmin)/64;          %设置颜色间隔的单位数据量
K=0.2;
plotMT2Dmodel(Xmish,Zmish,log(t),Sp,K);

f1=f';
D1=fopen('frequency','wt');
fprintf(D1,'%.6d\n',f1);
fclose(D1);                      %  保存频率文件
